---
title: "Permutation Test"
format:
  html: 
    code-tools:
      source: true
      toggle: false
      caption: "Code"
execute:
    warning: false
    message: false
---

In this project, I examined how working remotely vs. working in-office affects the productivity of individuals. The two variables analyzed are work setting (remote or in-office) and productivity, measured on a scale from 0 to 100 and adjusted based on employment status to reflect each individualâ€™s productivity level. Since the COVID-19 pandemic, remote work has become increasingly common, and it has started the debate about its impact on employee performance and overall productivity. By analyzing productivity across work settings, we can investigate whether remote work increases or decreases performance.

To understand the observed differences in productivity between the two groups, a box-plot was created to see the distribution of productivity for both remote and in-office workers:

```{r, echo=FALSE}
library(dplyr)
library(ggplot2)
library(purrr)

remote <- read.csv("remote_work_productivity.csv")

remote <- remote |> 
  mutate(
    typework = Employment_Type,
    productivity = Productivity_Score
  )

remote |> 
  ggplot(aes(x = typework, y = productivity)) +
  geom_boxplot() +
  labs(title = "Remove vs. In-Office: Difference in Productivity Score",
       x = "Work Type",
       y = "Productivity Score")
```
The box-plot shows that remote workers tend to have higher average productivity scores compared to in-office workers. To determine whether this observed difference is statistically significant, a permutation test using both the mean and the median was conducted. The null and alternative hypotheses are as follows:

Null Hypothesis: There is no difference in productivity between remote and in-office workers.

Alternative Hypothesis: There is a difference in productivity between remote and in-office workers.

The data for the type of work setting was shuffled 1000 times and the difference in means and medians was calculated to create a null distribution.

```{r, echo=FALSE}
remote_summary <- remote |> 
  group_by(typework) |> 
  summarize(ave_productivity = mean(productivity),
            med_productivity = median(productivity))

obs_diff <- remote |> 
  group_by(typework) |> 
  summarize(ave_productivity = mean(productivity),
            med_productivity = median(productivity)) |> 
  summarize(obs_ave_diff = diff(ave_productivity),
            obs_med_diff = diff(med_productivity))

perm_data <- function(rep, data){
  data |> 
    select(typework, productivity) |> 
    mutate(productivity_perm = sample(productivity, replace = FALSE)) |> 
    group_by(typework) |> 
    summarize(obs_ave = mean(productivity),
              obs_med = median(productivity),
              perm_ave = mean(productivity_perm),
              perm_med = median(productivity_perm)) |> 
    summarize(obs_ave_diff = diff(obs_ave),
              obs_med_diff = diff(obs_med),
              perm_ave_diff = diff(perm_ave),
              perm_med_diff = diff(perm_med),
              rep = rep)
}

map(c(1:10), perm_data, data = remote) |> 
  list_rbind()

set.seed(47)
perm_stats <- map(1:1000, perm_data, data = remote) |> 
  list_rbind()

perm_stats |> 
  ggplot(aes(x = perm_ave_diff)) + 
  geom_histogram() + 
  geom_vline(aes(xintercept = obs_ave_diff), color = "red") + 
    labs(title = "Null Distribution of Mean Difference for Remote vs. In-Office Work",
       x = "Permuted Mean Difference",
       y = "Count")

perm_stats |> 
  ggplot(aes(x = perm_med_diff)) + 
  geom_histogram() + 
  geom_vline(aes(xintercept = obs_med_diff), color = "red") +
    labs(title = "Null Distribution of Median Difference for Remote vs. In-Office Work",
       x = "Permuted Median Difference",
       y = "Count")
```
In the first histogram, each bar represents how often a certain mean difference in productivity (between remote and in-office workers) showed up when when the type of work was randomly shuffled. The red line shows the actual observed mean difference from the original data which was around 9.86. Most of the distribution is clustered around 0 and therefore, the likelihood of getting a difference as extreme as the observed one just by chance is extremely low. This suggests a statistically significant difference in mean productivity between remote and in-office workers.

The second histogram displays the same idea, but using the median instead of the mean. The red line shows the observed median difference and the distribution represents the shuffled version. Also in this graph, the red line with a value of 9 is very far away from the random outcomes which are clustered around 0. Therefore, the median difference is also statistically significant.

```{r, echo=FALSE}
perm_stats |> 
  summarize(p_val_ave = mean(perm_ave_diff > obs_ave_diff),
            p_val_med = mean(perm_med_diff > obs_med_diff))
```
Since the p-values are 0, we reject the null hypothesis. This provides strong evidence that remote workers are more productive than in-office workers, and that the observed differences are unlikely to be due to chance

The data set used for this project comes from a Kaggle and was published by Akash Yadav, which contains survey-based data comparing productivity between remote and in-office workers: https://www.kaggle.com/code/hbsaakashyadav/remote-work-productivity/input

